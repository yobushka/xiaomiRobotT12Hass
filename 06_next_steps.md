> **‚ö†Ô∏è –ê–†–•–ò–í / HISTORY FILE**
> –≠—Ç–æ—Ç —Ñ–∞–π–ª —è–≤–ª—è–µ—Ç—Å—è —á–∞—Å—Ç—å—é –∏—Å—Ç–æ—Ä–∏–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –¥–∞–Ω–Ω—ã–µ.

---

# –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –¥–µ–π—Å—Ç–≤–∏—è

## üîç –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

### 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Mi Home –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ‚ö†Ô∏è –ü–†–ò–û–†–ò–¢–ï–¢ #1

**–ó–∞—á–µ–º:** –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è —É–±–æ—Ä–∫–∏ –ø–æ –∫–æ–º–Ω–∞—Ç–∞–º –≤–æ–æ–±—â–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –¥–ª—è —ç—Ç–æ–π –º–æ–¥–µ–ª–∏.

**–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ Mi Home –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ
2. –í—ã–±–µ—Ä–∏—Ç–µ –ø—ã–ª–µ—Å–æ—Å Xiaomi Robot Vacuum T12
3. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–∞—Ä—Ç—É –∫–≤–∞—Ä—Ç–∏—Ä—ã
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
   - ‚úÖ –†–∞–∑–¥–µ–ª–µ–Ω–∞ –ª–∏ –∫–∞—Ä—Ç–∞ –Ω–∞ –∫–æ–º–Ω–∞—Ç—ã?
   - ‚úÖ –ú–æ–∂–Ω–æ –ª–∏ –≤—ã–±—Ä–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—É—é –∫–æ–º–Ω–∞—Ç—É –¥–ª—è —É–±–æ—Ä–∫–∏?
   - ‚úÖ –ï—Å—Ç—å –ª–∏ –Ω–∞–∑–≤–∞–Ω–∏—è —É –∫–æ–º–Ω–∞—Ç?

**–ï—Å–ª–∏ –∫–æ–º–Ω–∞—Ç –ù–ï–¢:**
- –°–æ–∑–¥–∞–π—Ç–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã –≤ Mi Home
- –î–∞–π—Ç–µ –∫–æ–º–Ω–∞—Ç–∞–º –Ω–∞–∑–≤–∞–Ω–∏—è
- –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å —É–±–æ—Ä–∫—É –æ–¥–Ω–æ–π –∫–æ–º–Ω–∞—Ç—ã
- –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ —Ç–µ—Å—Ç—ã –≤ HA

**–ï—Å–ª–∏ –∫–æ–º–Ω–∞—Ç—ã –ï–°–¢–¨:**
- –ó–∞–ø–∏—à–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏—è –≤—Å–µ—Ö –∫–æ–º–Ω–∞—Ç
- –ó–∞–ø—É—Å—Ç–∏—Ç–µ —É–±–æ—Ä–∫—É –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∫–æ–º–Ω–∞—Ç—ã —á–µ—Ä–µ–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- –û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ HA (—Å–º. –Ω–∏–∂–µ)

---

### 2. –õ–æ–≥–∏ –≤–æ –≤—Ä–µ–º—è —É–±–æ—Ä–∫–∏ —á–µ—Ä–µ–∑ Mi Home

**–ó–∞—á–µ–º:** –ü–æ–Ω—è—Ç—å, –∫–∞–∫–∞—è –∫–æ–º–∞–Ω–¥–∞ —Ä–µ–∞–ª—å–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø—ã–ª–µ—Å–æ—Å—É.

**–ö–æ–º–∞–Ω–¥–∞:**
```bash
ssh root@192.168.1.X
docker logs -f homeassistant | grep -i "xiaomi\|vacuum\|room\|segment"
```

**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —ç—Ç—É –∫–æ–º–∞–Ω–¥—É –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ
2. –í Mi Home –∑–∞–ø—É—Å—Ç–∏—Ç–µ —É–±–æ—Ä–∫—É –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∫–æ–º–Ω–∞—Ç—ã
3. –ù–∞–±–ª—é–¥–∞–π—Ç–µ –∑–∞ –ª–æ–≥–∞–º–∏
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤—Å–µ —á—Ç–æ –ø–æ—è–≤–∏—Ç—Å—è
5. –ù–∞–π–¥–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏

---

### 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—ã–ª–µ—Å–æ—Å–∞

**–ö–æ–º–∞–Ω–¥–∞:**
```bash
TOKEN="REDACTED_LONG_LIVED_ACCESS_TOKEN"

curl -X GET http://localhost:8123/api/states/vacuum.xiaomi_b106bk_807e_robot_cleaner \
  -H "Authorization: Bearer $TOKEN" | jq
```

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:**
- –°—Ç–∞—Ç—É—Å (status)
- –ó–∞—Ä—è–¥ –±–∞—Ç–∞—Ä–µ–∏
- –†–µ–∂–∏–º (mode)

**–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å:**
–°–Ω—è—Ç—å –ø—ã–ª–µ—Å–æ—Å —Å –∑–∞—Ä—è–¥–∫–∏ –∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å —Ç–µ—Å—Ç—ã –∫–æ–º–∞–Ω–¥ —É–±–æ—Ä–∫–∏ –∫–æ–º–Ω–∞—Ç.

---

## üß™ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã

### –¢–µ—Å—Ç #1: –î—Ä—É–≥–∏–µ —Ñ–æ—Ä–º–∞—Ç—ã params

```bash
# –ú–∞—Å—Å–∏–≤ –º–∞—Å—Å–∏–≤–æ–≤
curl -X POST http://localhost:8123/api/services/xiaomi_miot/call_action \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d {entity_id: vacuum.xiaomi_b106bk_807e_robot_cleaner, siid: 4, aiid: 1, params: [[16]]}

# –°—Ç—Ä–æ–∫–∞ –≤–º–µ—Å—Ç–æ —á–∏—Å–ª–∞  
curl -X POST http://localhost:8123/api/services/xiaomi_miot/call_action \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d {entity_id: vacuum.xiaomi_b106bk_807e_robot_cleaner, siid: 4, aiid: 1, params: [16]}

# JSON –æ–±—ä–µ–∫—Ç
curl -X POST http://localhost:8123/api/services/xiaomi_miot/call_action \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d {entity_id: vacuum.xiaomi_b106bk_807e_robot_cleaner, siid: 4, aiid: 1, params: [{segment_id: 16}]}
```

### –¢–µ—Å—Ç #2: MIoT —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è

–ü–æ–ª—É—á–∏—Ç—å –ø–æ–ª–Ω—É—é —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞:

```bash
docker exec homeassistant python3 << EOF
import asyncio
from custom_components.xiaomi_miot.core.miot_spec import MiotSpec

async def get_spec():
    spec = await MiotSpec.async_from_type("xiaomi.vacuum.b106bk")
    if spec:
        for service in spec.services.values():
            print(f"Service {service.iid}: {service.name}")
            for action in service.actions.values():
                print(f"  Action {action.iid}: {action.name}")
                if hasattr(action, "in_"):
                    print(f"    Parameters: {action.in_}")

asyncio.run(get_spec())
EOF
```

---

## üîÑ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã

### –í–∞—Ä–∏–∞–Ω—Ç –ê: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Mi Home –¥–ª—è –≤—ã–±–æ—Ä–∞ –∫–æ–º–Ω–∞—Ç—ã

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
1. –í HA —Å–æ–∑–¥–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—é –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é
2. –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∑–∞–ø—É—Å–∫–∞–µ—Ç webhook –∏–ª–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –∫–æ–º–Ω–∞—Ç—É –≤ Mi Home –≤—Ä—É—á–Ω—É—é

**–ü–ª—é—Å—ã:**
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç —Ä–µ—à–µ–Ω–∏—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–±–ª–µ–º—ã

**–ú–∏–Ω—É—Å—ã:**
- –ù–µ –ø–æ–ª–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è
- –¢—Ä–µ–±—É–µ—Ç —É—á–∞—Å—Ç–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –í–∞—Ä–∏–∞–Ω—Ç –ë: –ó–æ–Ω—ã –≤–º–µ—Å—Ç–æ –∫–æ–º–Ω–∞—Ç

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–í–º–µ—Å—Ç–æ ID –∫–æ–º–Ω–∞—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∑–æ–Ω –Ω–∞ –∫–∞—Ä—Ç–µ.

**–ö–æ–º–∞–Ω–¥–∞:**
```yaml
service: vacuum.send_command
data:
  entity_id: vacuum.xiaomi_b106bk_807e_robot_cleaner
  command: app_zoned_clean
  params:
    - [25000, 25000, 26000, 26000, 1]
```

**–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã:**
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å xiaomi_cloud_map_extractor (–µ—Å–ª–∏ –ø–æ–ª—É—á–∏—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è)
2. –ò–ª–∏ –≤—Ä—É—á–Ω—É—é –º–µ—Ç–æ–¥–æ–º –ø—Ä–æ–±

### –í–∞—Ä–∏–∞–Ω—Ç –í: –ì–æ–ª–æ—Å–æ–≤–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

**–ß–µ—Ä–µ–∑ –Ø–Ω–¥–µ–∫—Å –°—Ç–∞–Ω—Ü–∏—é** (–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è yandex_station —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞):

1. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏–∏ –≤ –Ø–Ω–¥–µ–∫—Å–µ
2. "–ê–ª–∏—Å–∞, —É–±–µ—Ä–∏ –∫—É—Ö–Ω—é" ‚Üí –∑–∞–ø—É—Å–∫–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç —á–µ—Ä–µ–∑ HA
3. –°–∫—Ä–∏–ø—Ç –≤—ã–∑—ã–≤–∞–µ—Ç Mi Home API –∏–ª–∏ webhook

---

## üìã –ß–µ–∫–ª–∏—Å—Ç –ø—Ä–æ–≤–µ—Ä–æ–∫

- [ ] –û—Ç–∫—Ä—ã—Ç Mi Home, –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞ –∫–∞—Ä—Ç–∞
- [ ] –ö–æ–º–Ω–∞—Ç—ã —Ä–∞–∑–¥–µ–ª–µ–Ω—ã –∏ –Ω–∞–∑–≤–∞–Ω—ã
- [ ] –£–±–æ—Ä–∫–∞ –æ–¥–Ω–æ–π –∫–æ–º–Ω–∞—Ç—ã —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ Mi Home
- [ ] –ó–∞–ø–∏—Å–∞–Ω—ã –ª–æ–≥–∏ HA –≤–æ –≤—Ä–µ–º—è —É–±–æ—Ä–∫–∏ —á–µ—Ä–µ–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- [ ] –ü—ã–ª–µ—Å–æ—Å —Å–Ω—è—Ç —Å –∑–∞—Ä—è–¥–∫–∏ –ø–µ—Ä–µ–¥ —Ç–µ—Å—Ç–∞–º–∏
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã params
- [ ] –ü–æ–ª—É—á–µ–Ω–∞ MIoT —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è
- [ ] –†–∞—Å—Å–º–æ—Ç—Ä–µ–Ω—ã –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã

---

## üìû –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–æ–≥–ª–æ

### –û–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ —Å–æ–æ–±—â–µ—Å—Ç–≤—É:

1. **Home Assistant Community**
   - https://community.home-assistant.io/
   - –¢–µ–º–∞: Xiaomi Vacuum b106bk room cleaning

2. **GitHub xiaomi_miot**
   - https://github.com/al-one/hass-xiaomi-miot/issues
   - –°–æ–∑–¥–∞—Ç—å issue —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –ø—Ä–æ–±–ª–µ–º—ã

3. **Reddit r/homeassistant**
   - –°–ø—Ä–æ—Å–∏—Ç—å –æ –ø–æ–¥–¥–µ—Ä–∂–∫–µ –º–æ–¥–µ–ª–∏ b106bk

### –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è –æ—Ç—á–µ—Ç–∞:

```
Model: xiaomi.vacuum.b106bk
Home Assistant: 2026.2.1
xiaomi_miot: v1.1.2
DID: 1062821236

Problem: Room cleaning commands accepted (HTTP 200) but vacuum does not move

Tested:
- siid=4, aiid=1, params=[10-20]
- All return HTTP 200, []
- Vacuum remains on charger, no movement

Request help with correct SIID/AIID/params format for room cleaning.
```

---

## üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ —Ñ–∞–π–ª—ã –≤ `/root/vacuum_robot/`:

```bash
# –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –ø—Ä–æ–≤–µ—Ä–æ–∫
nano /root/vacuum_robot/07_test_results.md

# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ª–æ–≥–∏
docker logs homeassistant > /root/vacuum_robot/logs_$(date +%Y%m%d_%H%M%S).txt

# –°–¥–µ–ª–∞—Ç—å –±—ç–∫–∞–ø –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
cp /root/docker/homeassistant/config/scripts.yaml \
   /root/vacuum_robot/scripts_backup_$(date +%Y%m%d).yaml
```
